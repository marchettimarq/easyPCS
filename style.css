:root{
  --bg:#0B1020; --card:#121A2C; --text:#E6EAF5; --muted:#9AA7C7; --border:#20283A;
  --brand:#2F6BFF; --brand-2:#1E53E6; --ok:#22c55e; --warn:#fbbf24;
  --tap:48px; --nav-icon:32px; --nav-icon-primary:38px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font:16px system-ui, -apple-system, Segoe UI, Roboto, sans-serif;}

.appbar{position:sticky;top:0;z-index:5;background:linear-gradient(180deg,#0e1526,#0b1020);padding:12px calc(16px + env(safe-area-inset-left)) 12px calc(16px + env(safe-area-inset-right));display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border)}
.brand{font-weight:800;font-size:22px;letter-spacing:.3px}
.brand span{color:var(--brand)}
.appbar .ghost{background:transparent;border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:12px}
.icon-btn{background:transparent;border:none;color:var(--text);font-size:24px;padding:8px;border-radius:10px}

.view{padding:12px 12px calc(84px + env(safe-area-inset-bottom));}
.hidden{display:none}

.carousel{display:flex;gap:14px;overflow-x:auto;scroll-snap-type:x mandatory;padding-bottom:6px}
.carousel::-webkit-scrollbar{display:none}
.phase-card{scroll-snap-align:center; min-width:88%; background:var(--card); border:1px solid var(--border); border-radius:18px; padding:14px; box-shadow:0 6px 24px rgba(0,0,0,.25)}
.phase-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
.phase-title{font-size:18px;font-weight:700;outline:none;background:transparent;border:none;color:var(--text);max-width:80%}
.progress{height:6px;background:#101728;border-radius:999px;overflow:hidden;margin:6px 0 2px}
.progress>span{display:block;height:100%;background:linear-gradient(90deg,var(--brand),var(--brand-2));width:0%}
.stat{font-size:12px;color:var(--muted)}

.list{display:flex;flex-direction:column;gap:10px;margin-top:10px}
.task{background:rgba(255,255,255,.02);border:1px solid var(--border);border-radius:14px;padding:12px;display:flex;align-items:flex-start;gap:12px}
.chk{width:28px;height:28px;min-width:28px;border-radius:50%;border:2px solid var(--muted);display:grid;place-items:center;cursor:pointer;user-select:none}
.chk.checked{border-color:var(--brand);background:rgba(47,107,255,.2)}
.chk .dot{width:14px;height:14px;border-radius:50%;background:transparent}
.chk.checked .dot{background:var(--brand)}
.meta{flex:1}
.title{font-weight:600;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;word-break:break-word}
.sub{color:var(--muted);font-size:12px;margin-top:4px}
.actions{display:flex;gap:8px}
.btn{background:transparent;border:1px solid var(--border);color:var(--text);padding:6px 10px;border-radius:10px}

.collapsed .completed{display:none}
.completed-toggle{margin-top:10px}
.completed{margin-top:10px;opacity:.9}

.pager{display:flex;gap:8px;justify-content:center;margin-top:8px}
.pager button{width:8px;height:8px;border-radius:50%;border:none;background:#2a3246;opacity:.6}
.pager button.active{background:var(--brand);opacity:1}

.bottom-nav{position:fixed;bottom:0;left:0;right:0;background:#0e1526;border-top:1px solid var(--border);display:flex;justify-content:space-around;align-items:center;padding:8px calc(12px + env(safe-area-inset-right)) calc(8px + env(safe-area-inset-bottom)) calc(12px + env(safe-area-inset-left));z-index:6}
.nav-btn{min-width:var(--tap);min-height:var(--tap);background:transparent;border:none;color:var(--text);display:flex;flex-direction:column;align-items:center;gap:2px}
.nav-btn .icon{font-size:var(--nav-icon)}
.nav-btn.primary .icon{font-size:var(--nav-icon-primary)}
.lbl{font-size:12px;color:var(--muted)}

.sheet{position:fixed;inset:0;background:rgba(0,0,0,.4);backdrop-filter:blur(3px);display:grid;place-items:end center;z-index:10}
.sheet-card{background:var(--card);border:1px solid var(--border);border-radius:18px 18px 0 0;padding:12px;width:100%;max-width:560px}
.sheet-head{display:flex;justify-content:space-between;align-items:center}
.sheet-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:10px}
.sheet.hidden{display:none}

.section-title{margin:8px 0 6px 4px}
.timeline{display:flex;flex-direction:column;gap:10px}
.time-row{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}
.time-row .date{color:var(--muted);font-size:12px}
